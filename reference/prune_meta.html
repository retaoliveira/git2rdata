<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prune Metadata Files — prune_meta • git2rdata</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Prune Metadata Files — prune_meta" />
<meta property="og:description" content="Removes all valid metadata (.yml files) from the path when they don't
have accompanying data (.tsv file). Invalid metadata triggers a warning
without removing the metadata file.
Use this function with caution since it will remove all valid metadata files
without asking for confirmation. We strongly recommend to use this
function on files under version control. See
vignette(&quot;workflow&quot;, package = &quot;git2rdata&quot;) for some examples on how to use
this." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">git2rdata</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../news/index.html">NEWS</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plain_text.html">Getting started storing dataframes as plain text</a>
    </li>
    <li>
      <a href="../articles/version_control.html">Storing dataframes under version control</a>
    </li>
    <li>
      <a href="../articles/workflow.html">Potential workflow</a>
    </li>
    <li>
      <a href="../articles/efficiency.html">Efficiency</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../CONTRIBUTING.html">Contributing</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/git2rdata">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/INBOVlaanderen">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://www.facebook.com/pg/INBOVlaanderen">
    <span class="fa fa-facebook fg-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prune Metadata Files</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/git2rdata/blob/master/R/prune.R'><code>R/prune.R</code></a></small>
    <div class="hidden name"><code>prune_meta.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Removes all <strong>valid</strong> metadata (<code>.yml</code> files) from the <code>path</code> when they don't
have accompanying data (<code>.tsv</code> file). <strong>Invalid</strong> metadata triggers a warning
without removing the metadata file.</p>
<p>Use this function with caution since it will remove all valid metadata files
without asking for confirmation. We strongly recommend to use this
function on files under version control. See
<code><a href='../articles/workflow.html'>vignette("workflow", package = "git2rdata")</a></code> for some examples on how to use
this.</p>
    </div>

    <pre class="usage"><span class='fu'>prune_meta</span>(<span class='kw'>root</span> <span class='kw'>=</span> <span class='st'>"."</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)

<span class='co'># S3 method for git_repository</span>
<span class='fu'>prune_meta</span>(<span class='no'>root</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>, <span class='kw'>stage</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>root</th>
      <td><p>The root of a project. Can be a file path or a <code>git-repository</code>.
Defaults to the current working directory (<code>"."</code>).</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>the directory in which to clean all the data files. The directory
is relative to <code>root</code>.</p></td>
    </tr>
    <tr>
      <th>recursive</th>
      <td><p>remove files in subdirectories too.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>parameters used in some methods</p></td>
    </tr>
    <tr>
      <th>stage</th>
      <td><p>stage the changes after removing the files. Defaults to <code>FALSE</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>returns invisibly a vector of removed files names. The paths are
relative to <code>root</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other storage: 
<code><a href='list_data.html'>list_data</a>()</code>,
<code><a href='read_vc.html'>read_vc</a>()</code>,
<code><a href='relabel.html'>relabel</a>()</code>,
<code><a href='rm_data.html'>rm_data</a>()</code>,
<code><a href='write_vc.html'>write_vc</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## on file system</span>

<span class='co'># create a directory</span>
<span class='no'>root</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>(<span class='st'>"git2rdata-"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span>(<span class='no'>root</span>)

<span class='co'># store a dataframe as git2rdata object. Capture the result to minimise</span>
<span class='co'># screen output</span>
<span class='no'>junk</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='write_vc.html'>write_vc</a></span>(<span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>6</span>, ], <span class='st'>"iris"</span>, <span class='no'>root</span>, <span class='kw'>sorting</span> <span class='kw'>=</span> <span class='st'>"Sepal.Length"</span>)
<span class='co'># write a standard tab separate file (non git2rdata object)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/write.table.html'>write.table</a></span>(<span class='no'>iris</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>root</span>, <span class='st'>"standard.tsv"</span>), <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"\t"</span>)
<span class='co'># write a YAML file</span>
<span class='no'>yml</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
  <span class='kw'>authors</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
   <span class='st'>"Research Institute for Nature and Forest"</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(
       <span class='kw'>href</span> <span class='kw'>=</span> <span class='st'>"https://www.inbo.be/en"</span>)))
<span class='kw pkg'>yaml</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/yaml/man/write_yaml.html'>write_yaml</a></span>(<span class='no'>yml</span>, <span class='kw'>file</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/file.path.html'>file.path</a></span>(<span class='no'>root</span>, <span class='st'>"_pkgdown.yml"</span>))

<span class='co'># list the git2rdata objects</span>
<span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>root</span>)</div><div class='output co'>#&gt; [1] "iris"</div><div class='input'><span class='co'># list the files</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='no'>root</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] "_pkgdown.yml" "iris.tsv"     "iris.yml"     "standard.tsv"</div><div class='input'>
<span class='co'># remove all .tsv files from valid git2rdata objects</span>
<span class='fu'><a href='rm_data.html'>rm_data</a></span>(<span class='no'>root</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"."</span>)
<span class='co'># check the removal of the .tsv file</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='no'>root</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] "_pkgdown.yml" "iris.yml"     "standard.tsv"</div><div class='input'><span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>root</span>)</div><div class='output co'>#&gt; character(0)</div><div class='input'>
<span class='co'># remove dangling git2rdata metadata files</span>
<span class='fu'>prune_meta</span>(<span class='no'>root</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"."</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Invalid metadata files found. See ?is_git2rmeta():</span>
#&gt; <span class='warning'>_pkgdown.yml</span></div><div class='input'><span class='co'># check the removal of the metadata</span>
<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='no'>root</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [1] "_pkgdown.yml" "standard.tsv"</div><div class='input'><span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>root</span>)</div><div class='output co'>#&gt; character(0)</div><div class='input'>

<span class='co'>## on git repo</span>

<span class='co'># initialise a git repo using git2r</span>
<span class='no'>repo_path</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>(<span class='st'>"git2rdata-repo-"</span>)
<span class='fu'><a href='https://rdrr.io/r/base/files2.html'>dir.create</a></span>(<span class='no'>repo_path</span>)
<span class='no'>repo</span> <span class='kw'>&lt;-</span> <span class='kw pkg'>git2r</span><span class='kw ns'>::</span><span class='fu'><a href='https://docs.ropensci.org/git2r/reference/init.html'>init</a></span>(<span class='no'>repo_path</span>)
<span class='kw pkg'>git2r</span><span class='kw ns'>::</span><span class='fu'><a href='https://docs.ropensci.org/git2r/reference/config.html'>config</a></span>(<span class='no'>repo</span>, <span class='kw'>user.name</span> <span class='kw'>=</span> <span class='st'>"Alice"</span>, <span class='kw'>user.email</span> <span class='kw'>=</span> <span class='st'>"alice@example.org"</span>)

<span class='co'># store a dataframe</span>
<span class='fu'><a href='write_vc.html'>write_vc</a></span>(<span class='no'>iris</span>[<span class='fl'>1</span>:<span class='fl'>6</span>, ], <span class='st'>"iris"</span>, <span class='no'>repo</span>, <span class='kw'>sorting</span> <span class='kw'>=</span> <span class='st'>"Sepal.Length"</span>, <span class='kw'>stage</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; 09d5bfd6a65e682a4ca030c766348180861568c8 
#&gt;                               "iris.tsv" 
#&gt; 0d434e56d22a710c99c5b912e8624d52abd41aaf 
#&gt;                               "iris.yml" </div><div class='input'><span class='co'># check that the dataframe is stored</span>
<span class='fu'><a href='status.html'>status</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; Staged changes:
#&gt; 	New:        iris.tsv
#&gt; 	New:        iris.yml
#&gt; </div><div class='input'><span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; [1] "iris"</div><div class='input'>
<span class='co'># commit the current version and check the git repo</span>
<span class='fu'><a href='commit.html'>commit</a></span>(<span class='no'>repo</span>, <span class='st'>"add iris data"</span>, <span class='kw'>session</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; [ba268d8] 2020-08-19: add iris data</div><div class='input'><span class='fu'><a href='status.html'>status</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; working directory clean</div><div class='input'>
<span class='co'># remove the data files from the repo</span>
<span class='fu'><a href='rm_data.html'>rm_data</a></span>(<span class='no'>repo</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"."</span>)
<span class='co'># check the removal</span>
<span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; character(0)</div><div class='input'><span class='fu'><a href='status.html'>status</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; Unstaged changes:
#&gt; 	Deleted:    iris.tsv
#&gt; </div><div class='input'>
<span class='co'># remove dangling metadata</span>
<span class='fu'>prune_meta</span>(<span class='no'>repo</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='st'>"."</span>)
<span class='co'># check the removal</span>
<span class='fu'><a href='list_data.html'>list_data</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; character(0)</div><div class='input'><span class='fu'><a href='status.html'>status</a></span>(<span class='no'>repo</span>)</div><div class='output co'>#&gt; Unstaged changes:
#&gt; 	Deleted:    iris.tsv
#&gt; 	Deleted:    iris.yml
#&gt; </div><div class='input'>
<span class='co'># clean up</span>
<span class='no'>junk</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span>(
  <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='no'>root</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>), <span class='no'>root</span>)
<span class='no'>junk</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/files.html'>file.remove</a></span>(
  <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='no'>repo_path</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>recursive</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
                 <span class='kw'>include.dirs</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>all.files</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)),
  <span class='no'>repo_path</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://www.muscardinus.be'>Thierry Onkelinx</a>, <a href='https://www.inbo.be/en'><img src='https://ropensci.github.io/git2rdata/reference/figures/logo-en.png' height=24></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


